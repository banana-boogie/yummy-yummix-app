# YummyYummix

A cross-platform cooking app with recipe discovery, step-by-step cooking guides, and AI-powered sous chef features.

## Quick Start

### Prerequisites

- Node.js 18+
- Docker Desktop (for local Supabase)
- Supabase CLI: `brew install supabase/tap/supabase`
- jq (optional, for user seeding): `brew install jq`
- Xcode (for iOS) or Android Studio (for Android)

### Setup

```bash
# Clone and install
git clone <repo-url>
cd yummy-yummix-app/yyx-app
npm install

# One-command setup: starts Supabase, configures env, seeds dev user
npm run dev:setup

# Run the app on iPhone
npm run ios
```

That's it! On the login screen, tap **"Dev Login"** to sign in instantly.

## Development Workflow

### Daily Development

```bash
cd yyx-app
npm run dev:check    # Verify everything is running
npm run ios          # Run the app
```

### If Supabase Needs Starting

```bash
cd yyx-server
npm start            # Start Supabase
npm run status       # Check status
npm stop             # Stop when done
```

### Database Changes

**Create migration:**
```bash
cd yyx-server
supabase migration new add_feature_name
```

**Edit the migration:**
- File: `yyx-server/supabase/migrations/TIMESTAMP_add_feature_name.sql`
- Add your SQL (CREATE TABLE, ALTER TABLE, etc.)

**Test locally:**
```bash
supabase db reset  # Drops DB, reapplies all migrations from scratch
```

**Deploy to production:**
```bash
supabase db push
```

### Edge Functions

**Test locally:**
```bash
cd yyx-server
supabase functions serve [function-name] --env-file .env
```

**Deploy:**
```bash
supabase functions deploy [function-name]
```

## Project Structure

```
yummy-yummix-app/
├── yyx-app/              # React Native mobile app (Expo)
│   ├── app/              # Expo Router screens (file-based routing)
│   ├── components/       # Reusable UI components
│   ├── contexts/         # React contexts (Auth, Language, etc.)
│   ├── services/         # API services
│   ├── hooks/            # Custom React hooks
│   ├── lib/              # Supabase client setup
│   ├── .env              # Production config (gitignored)
│   └── .env.local        # Local dev config (committed)
│
└── yyx-server/           # Backend
    └── supabase/
        ├── functions/    # Edge Functions (Deno/TypeScript)
        └── migrations/   # Database migrations
```

## Tech Stack

- **Framework**: React Native + Expo
- **Styling**: NativeWind (Tailwind for React Native)
- **Backend**: Supabase (Auth, Database, Storage, Edge Functions)
- **Routing**: Expo Router (file-based)
- **Languages**: TypeScript, i18n (English + Spanish)

## Common Commands

### Mobile App (yyx-app/)
```bash
npm run dev:setup    # One-time setup (starts Supabase, configures env)
npm run dev:check    # Verify local dev is ready
npm run ios          # Run on physical iPhone
npm run ios:sim      # Run on iOS Simulator
npm run ios:prod     # Build with production Supabase
npm run android      # Run on Android
npm test             # Run tests
npm run lint         # Lint code
```

### Supabase (yyx-server/)
```bash
npm start            # Start Supabase
npm stop             # Stop Supabase
npm run status       # Check status
npm run reset        # Reset DB and reapply migrations
npm run get-test-jwt # Get JWT for curl testing
```

## Environment Variables

### `.env.local` (Local Development - Committed)
Auto-generated by `npm run dev:setup`. Safe to commit (no secrets).

```env
EXPO_PUBLIC_SUPABASE_URL=http://192.168.1.x:54321
EXPO_PUBLIC_SUPABASE_ANON_KEY=eyJhbGc...
EXPO_PUBLIC_DEV_LOGIN_EMAIL=dev@yummyyummix.local
EXPO_PUBLIC_DEV_LOGIN_PASSWORD=devpassword123
```

### `.env` (Production - Gitignored)
Contains production URLs and API keys. Never commit.

```env
EXPO_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
EXPO_PUBLIC_SUPABASE_ANON_KEY=xxx
OPENAI_API_KEY=sk-proj-xxx
USDA_API_KEY=xxx
```

## Troubleshooting

### Can't connect to local Supabase

Run `npm run dev:setup` to auto-detect your IP and reconfigure everything.

If that doesn't work:
1. Ensure Mac and iPhone are on the same WiFi
2. Check Supabase is running: `cd yyx-server && npm run status`
3. Check firewall allows port 54321

### Dev Login button doesn't appear

The button only shows when `EXPO_PUBLIC_DEV_LOGIN_EMAIL` and `EXPO_PUBLIC_DEV_LOGIN_PASSWORD` are set. Run `npm run dev:setup` to configure.

### Migrations out of sync

```bash
cd yyx-server
supabase db pull    # Pull current production schema
npm run reset       # Reset local to match
```

### Build artifacts appearing in git

Native folders (`ios/`, `android/`) are gitignored. They regenerate automatically.

## Contributing

1. Create a feature branch: `git checkout -b feature/my-feature`
2. Make changes and test locally with `supabase db reset`
3. Commit using conventional commits: `feat(scope): description`
4. Push and create a PR

## Documentation

- **CLAUDE.md**: Detailed conventions for AI assistance
- **README.md**: This file - getting started guide
- **Supabase Docs**: https://supabase.com/docs

## License

[Add your license]

## Support

[Add contact/support information]
